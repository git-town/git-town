"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const running_process_1 = require("../helpers/running-process");
/**
 * The "verifyProcessOutput" action waits until the currently running console command
 * produces the given output.
 */
async function verifyProcessOutput(args) {
    args.name("verifying the output of the long-running process");
    const expectedOutput = args.nodes.textInNodeOfType("fence");
    const expectedLines = expectedOutput
        .split("\n")
        .map(line => line.trim())
        .filter(line => line);
    const process = running_process_1.RunningProcess.instance().process;
    if (!process) {
        throw new Error("Cannot verify process output since no process has been started");
    }
    for (const line of expectedLines) {
        args.log(`waiting for ${line}`);
        await process.output.waitForText(line);
    }
}
exports.default = verifyProcessOutput;
//# sourceMappingURL=verify-process-output.js.map